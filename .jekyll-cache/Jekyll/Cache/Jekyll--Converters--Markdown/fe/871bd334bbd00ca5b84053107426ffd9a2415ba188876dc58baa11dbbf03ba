I"<h3 id="coroutine-jobs-in-kotlin-"><strong>Coroutine Jobs in Kotlin ?</strong><br /></h3>

<p><strong>참고</strong>:<a href="https://www.youtube.com/watch?v=UsHTxOILP5g">https://www.youtube.com/watch?v=UsHTxOILP5g</a></p>

<p>이번 포스팅에서는 Coroutine Job에 대해서 샘플 어플을 만들어가면서 알아볼 것이다.<br /></p>

<p>인터넷을 통해서 데이터를 취득하는 도중에 속도가 느리거나 timeout, 작업(Job)을 취소해야되는 경우, 과거에는 AsyncTask를 통해서 작업을 조작하는 것은 매우 어렵고 번거로웠다.(현재 deprecated되었다) <br />
이후에 개선되서 나온 것이 “RxJava”이다. 이 RxJava로 기존의 복잡했던 작업들이 좀 더 간단하게 처리할 수 있게 되었다. 각각의 option들이 잘 되어있어서 편리하게 처리할 수 있다는 장점이 있다.(에러가 발생하였을때, 등등..)<br />
그 다음은 “Coroutine”이다. Coroutine은 RxJava보다 더 편리하게 각각의 작업들은 간단하게 컨트롤할 수 있다.<br /></p>

<p><img src="/images/android/2020-04-18 coroutine job(1).png" alt="blog capture" title="capture img" width="300" /><br /></p>

<p>우선 샘플 어플의 처리과정을 정리해보자. <br />
이 어플은 화면에 ProgressBar가 있고, 버튼과 TextView가 있다.<br />
버튼을 눌렀을때 background thread에 해당 task가 실행이 되고, 그 task의 진행상태가 progress bar에 반영이 된다.<br />
(1) task실행이 완료되었을때, TextView에 “Job is complete”표시가 된다.<br />
(2) 실행되는 도중에 “CANCEL JOB #1”을 누르면 “resetting job” Toast 메시지가 표시가 된다.<br /></p>

<p><strong><font color="Red">※ 내부 처리 작성하기</font></strong><br /></p>

<p>① Field 변수로 Progress bar 관련 변수 <strong>“PROGRESS_MAX=100, PROGRESS_START, JOB_TIME=400(ms)”</strong>와 CompletableJob변수 <strong>“job”</strong>변수를 선언해준다. <br />
② “START JOB #1” 버튼을 클릭했을때, job 변수가 초기화되어 있지 않은 경우 job을 초기화시켜주고, Task 작업을 실행해준다.<br /></p>

<p><strong>Coroutine Job의 초기화 메소드</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fun initJob(){
    // button의 text를 setting
    job_button.text = "start Job #1"
    // 초기 TextView의 text를 ""로 초기화
    updateJobCompleteTextView("")
    // job변수의 초기화
    job = Job()
    // job이 취소되거나 완성되었을때 실행되는 invokeOnCompletion 처리하기
    job.invokeOnCompletion{
      it?.message.let{
        var msg = it
        if(msg.isNullOrBlank()){
          msg = "Unknown cancellation error"
        }
        println("${job}was cancelled. Reason: $msg")
        showToast(msg)
      }
    }
}
</code></pre></div></div>

<p>③ <br />
④ <br />
⑤ <br /></p>

<h3 id="전체적인-학습내용을-복습한다">전체적인 학습내용을 복습한다.<br /></h3>
<p>1.</p>
:ET